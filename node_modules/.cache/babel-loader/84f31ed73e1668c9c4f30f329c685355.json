{"ast":null,"code":"import _regeneratorRuntime from \"/Users/Shared/myProject/GitHub/Jamming/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/Shared/myProject/GitHub/Jamming/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar accessToken;\nvar expiresIn;\nvar clientId = \"59649a72094c46508c95980e7a188a9d\";\nvar authEndpoint = \"https://accounts.spotify.com/authorize\";\nvar redirectUri = \"https://everly.surge.sh\"; //const redirectUri = \"http://localhost:3000\";\n\nvar Spotify = {\n  getAccessToken: function getAccessToken() {\n    if (accessToken) {\n      return accessToken;\n    } else {\n      if (window.location.href.match(/access_token=([^&]*)/) && window.location.href.match(/expires_in=([^&]*)/)) {\n        accessToken = window.location.href.match(/access_token=([^&]*)/)[1];\n        expiresIn = window.location.href.match(/expires_in=([^&]*)/)[1];\n        window.setTimeout(function () {\n          return accessToken = \"\";\n        }, expiresIn * 1000);\n        window.history.pushState(\"Access Token\", null, \"/\");\n        return accessToken;\n      } else {\n        var url = \"\".concat(authEndpoint, \"?client_id=\").concat(clientId, \"&response_type=token&scope=playlist-modify-public&redirect_uri=\").concat(redirectUri);\n        window.location = url;\n      }\n    }\n  },\n  search: function search(searchTerm) {\n    accessToken = this.getAccessToken();\n    return fetch(\"https://api.spotify.com/v1/search?type=track&q=\".concat(searchTerm.replace(\" \", \"%20\")), {\n      headers: {\n        Authorization: \"Bearer \".concat(accessToken)\n      }\n    }).then(function (response) {\n      return response.json();\n    }).then(function (jsonResponse) {\n      if (jsonResponse.tracks.items) {\n        return jsonResponse.tracks.items.map(function (track) {\n          return {\n            id: track.id,\n            name: track.name,\n            artist: track.artists[0].name,\n            album: track.album.name,\n            uri: track.uri\n          };\n        });\n      }\n    });\n  },\n  savePlaylist: function () {\n    var _savePlaylist = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(playlistName, trackUris) {\n      var userId, playlistId, response, jsonResponse, nameResponse, tracksResponse;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(!playlistName || !trackUris)) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 2:\n              accessToken = this.getAccessToken();\n              _context.prev = 3;\n              _context.next = 6;\n              return fetch(\"https://api.spotify.com/v1/me\", {\n                headers: {\n                  Authorization: \"Bearer \".concat(accessToken)\n                }\n              });\n\n            case 6:\n              response = _context.sent;\n\n              if (response.ok) {\n                _context.next = 10;\n                break;\n              }\n\n              alert(\"There was a problem retrieving your user ID.\");\n              return _context.abrupt(\"return\");\n\n            case 10:\n              _context.next = 12;\n              return response.json();\n\n            case 12:\n              jsonResponse = _context.sent;\n              userId = jsonResponse.id;\n              _context.next = 16;\n              return fetch(\"https://api.spotify.com/v1/users/\".concat(userId, \"/playlists\"), {\n                method: \"POST\",\n                headers: {\n                  Authorization: \"Bearer \".concat(accessToken),\n                  \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                  name: playlistName\n                })\n              });\n\n            case 16:\n              nameResponse = _context.sent;\n\n              if (nameResponse.ok) {\n                _context.next = 20;\n                break;\n              }\n\n              alert(\"There was a problem posting the playlist name.\");\n              return _context.abrupt(\"return\");\n\n            case 20:\n              _context.next = 22;\n              return nameResponse.json();\n\n            case 22:\n              jsonResponse = _context.sent;\n              playlistId = jsonResponse.uri;\n              _context.next = 26;\n              return fetch(\"https://api.spotify.com/v1/playlists/\".concat(playlistId, \"/tracks\"), {\n                method: \"POST\",\n                headers: {\n                  Authorization: \"Bearer \".concat(accessToken),\n                  \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                  uris: trackUris\n                })\n              });\n\n            case 26:\n              tracksResponse = _context.sent;\n\n              if (tracksResponse.ok) {\n                _context.next = 30;\n                break;\n              }\n\n              alert(\"There was a problem posting the playlist tracks.\");\n              return _context.abrupt(\"return\");\n\n            case 30:\n              _context.next = 36;\n              break;\n\n            case 32:\n              _context.prev = 32;\n              _context.t0 = _context[\"catch\"](3);\n              console.log(_context.t0);\n              return _context.abrupt(\"return\");\n\n            case 36:\n              return _context.abrupt(\"return\", \"Done\");\n\n            case 37:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[3, 32]]);\n    }));\n\n    function savePlaylist(_x, _x2) {\n      return _savePlaylist.apply(this, arguments);\n    }\n\n    return savePlaylist;\n  }()\n};\nexport default Spotify;","map":{"version":3,"sources":["/Users/Shared/myProject/GitHub/Jamming/src/util/Spodify.js"],"names":["accessToken","expiresIn","clientId","authEndpoint","redirectUri","Spotify","getAccessToken","window","location","href","match","setTimeout","history","pushState","url","search","searchTerm","fetch","replace","headers","Authorization","then","response","json","jsonResponse","tracks","items","map","track","id","name","artist","artists","album","uri","savePlaylist","playlistName","trackUris","ok","alert","userId","method","body","JSON","stringify","nameResponse","playlistId","uris","tracksResponse","console","log"],"mappings":"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","sourcesContent":["let accessToken;\nlet expiresIn;\nconst clientId = \"59649a72094c46508c95980e7a188a9d\";\nconst authEndpoint = \"https://accounts.spotify.com/authorize\";\nconst redirectUri = \"https://everly.surge.sh\";\n//const redirectUri = \"http://localhost:3000\";\n\nconst Spotify = {\n  getAccessToken() {\n    if (accessToken) {\n      return accessToken;\n    } else {\n      if (\n        window.location.href.match(/access_token=([^&]*)/) &&\n        window.location.href.match(/expires_in=([^&]*)/)\n      ) {\n        accessToken = window.location.href.match(/access_token=([^&]*)/)[1];\n        expiresIn = window.location.href.match(/expires_in=([^&]*)/)[1];\n        window.setTimeout(() => (accessToken = \"\"), expiresIn * 1000);\n        window.history.pushState(\"Access Token\", null, \"/\");\n        return accessToken;\n      } else {\n        let url = `${authEndpoint}?client_id=${clientId}&response_type=token&scope=playlist-modify-public&redirect_uri=${redirectUri}`;\n        window.location = url;\n      }\n    }\n  },\n\n  search(searchTerm) {\n    accessToken = this.getAccessToken();\n    return fetch(\n      `https://api.spotify.com/v1/search?type=track&q=${searchTerm.replace(\n        \" \",\n        \"%20\"\n      )}`,\n      {\n        headers: { Authorization: `Bearer ${accessToken}` }\n      }\n    )\n      .then(response => {\n        return response.json();\n      })\n      .then(jsonResponse => {\n        if (jsonResponse.tracks.items) {\n          return jsonResponse.tracks.items.map(track => ({\n            id: track.id,\n            name: track.name,\n            artist: track.artists[0].name,\n            album: track.album.name,\n            uri: track.uri\n          }));\n        }\n      });\n  },\n\n  async savePlaylist(playlistName, trackUris) {\n    if (!playlistName || !trackUris) {\n      return;\n    }\n    accessToken = this.getAccessToken();\n    let userId;\n    let playlistId;\n    try {\n      let response = await fetch(\"https://api.spotify.com/v1/me\", {\n        headers: { Authorization: `Bearer ${accessToken}` }\n      });\n      if (!response.ok) {\n        alert(\"There was a problem retrieving your user ID.\");\n        return;\n      }\n      let jsonResponse = await response.json();\n      userId = jsonResponse.id;\n      let nameResponse = await fetch(\n        `https://api.spotify.com/v1/users/${userId}/playlists`,\n        {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${accessToken}`,\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            name: playlistName\n          })\n        }\n      );\n      if (!nameResponse.ok) {\n        alert(\"There was a problem posting the playlist name.\");\n        return;\n      }\n      jsonResponse = await nameResponse.json();\n      playlistId = jsonResponse.uri;\n\n      let tracksResponse = await fetch(\n        `https://api.spotify.com/v1/playlists/${playlistId}/tracks`,\n        {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${accessToken}`,\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({ uris: trackUris })\n        }\n      );\n      if (!tracksResponse.ok) {\n        alert(\"There was a problem posting the playlist tracks.\");\n        return;\n      }\n    } catch (error) {\n      console.log(error);\n      return;\n    }\n    return \"Done\";\n  }\n};\n\nexport default Spotify;\n"]},"metadata":{},"sourceType":"module"}