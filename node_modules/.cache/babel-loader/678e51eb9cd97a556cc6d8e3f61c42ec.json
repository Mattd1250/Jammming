{"ast":null,"code":"import _regeneratorRuntime from \"/Users/Shared/myProject/GitHub/Jamming/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/Shared/myProject/GitHub/Jamming/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar accessToken;\nvar expiresIn;\nvar clientId = \"59649a72094c46508c95980e7a188a9d\";\nvar authEndpoint = \"https://accounts.spotify.com/authorize\";\nvar redirectUri = \"https://everly.surge.sh\"; //const redirectUri = \"http://localhost:3000\";\n\nvar Spotify = {\n  getAccessToken: function getAccessToken() {\n    if (accessToken) {\n      return accessToken;\n    } else {\n      accessToken = window.location.href.match(/access_token=([^&]*)/);\n      expiresIn = window.location.href.match(/expires_in=([^&]*)/);\n\n      if (accessToken && expiresIn) {\n        window.setTimeout(function () {\n          return accessToken = \"\";\n        }, expiresIn * 1000);\n        window.history.pushState(\"Access Token\", null, \"/\");\n        return accessToken;\n      } else {\n        var url = \"\".concat(authEndpoint, \"?client_id=\").concat(clientId, \"&response_type=token&scope=playlist-modify-public&redirect_uri=\").concat(redirectUri);\n        window.location = url;\n      }\n    }\n  },\n  search: function search(searchTerm) {\n    accessToken = this.getAccessToken();\n    console.log(accessToken);\n    return fetch(\"https://api.spotify.com/v1/search?type=track&q=\".concat(searchTerm.replace(\" \", \"%20\")), {\n      headers: {\n        Authorization: \"Bearer \".concat(accessToken)\n      }\n    }).then(function (response) {\n      return response.json();\n    }).then(function (jsonResponse) {\n      if (jsonResponse.tracks.items) {\n        return jsonResponse.tracks.items.map(function (track) {\n          return {\n            id: track.id,\n            name: track.name,\n            artist: track.artists[0].name,\n            album: track.album.name,\n            uri: track.uri\n          };\n        });\n      }\n    });\n  },\n  savePlaylist: function () {\n    var _savePlaylist = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(playlistName, trackUris) {\n      var headers, userId, response, jsonResponse, nameResponse, playlistId, tracksResponse;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(!playlistName || !trackUris)) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 2:\n              accessToken = this.getAccessToken();\n              console.log(accessToken);\n              headers = {\n                Authorizaion: \"Bearer \".concat(accessToken)\n              };\n              _context.prev = 5;\n              _context.next = 8;\n              return fetch(\"https://api.spotify.com/v1/me\", {\n                headers: headers\n              });\n\n            case 8:\n              response = _context.sent;\n\n              if (response.ok) {\n                _context.next = 12;\n                break;\n              }\n\n              alert(\"There was a problem retrieving your user ID.\");\n              return _context.abrupt(\"return\");\n\n            case 12:\n              _context.next = 14;\n              return response.json();\n\n            case 14:\n              jsonResponse = _context.sent;\n              userId = jsonResponse.id;\n              _context.next = 18;\n              return fetch(\"https://api.spotify.com/v1/users/\".concat(userId, \"/playlists\"), {\n                method: \"POST\",\n                headers: {\n                  Authorization: \"Bearer \".concat(accessToken),\n                  \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                  name: playlistName\n                })\n              });\n\n            case 18:\n              nameResponse = _context.sent;\n\n              if (nameResponse.ok) {\n                _context.next = 22;\n                break;\n              }\n\n              alert(\"There was a problem posting the playlist name.\");\n              return _context.abrupt(\"return\");\n\n            case 22:\n              _context.next = 24;\n              return nameResponse.json();\n\n            case 24:\n              jsonResponse = _context.sent;\n              playlistId = jsonResponse.id;\n              _context.next = 28;\n              return fetch(\"https://api.spotify.com/v1/playlists/\".concat(playlistId, \"/tracks\"), {\n                method: \"POST\",\n                headers: {\n                  Authorization: \"Bearer \".concat(accessToken),\n                  \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                  uris: trackUris\n                })\n              });\n\n            case 28:\n              tracksResponse = _context.sent;\n\n              if (tracksResponse.ok) {\n                _context.next = 32;\n                break;\n              }\n\n              alert(\"There was a problem posting the playlist tracks.\");\n              return _context.abrupt(\"return\");\n\n            case 32:\n              _context.next = 38;\n              break;\n\n            case 34:\n              _context.prev = 34;\n              _context.t0 = _context[\"catch\"](5);\n              console.log(_context.t0);\n              return _context.abrupt(\"return\");\n\n            case 38:\n              return _context.abrupt(\"return\", \"Done\");\n\n            case 39:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[5, 34]]);\n    }));\n\n    function savePlaylist(_x, _x2) {\n      return _savePlaylist.apply(this, arguments);\n    }\n\n    return savePlaylist;\n  }()\n};\nexport default Spotify;","map":{"version":3,"sources":["/Users/Shared/myProject/GitHub/Jamming/src/util/Spodify.js"],"names":["accessToken","expiresIn","clientId","authEndpoint","redirectUri","Spotify","getAccessToken","window","location","href","match","setTimeout","history","pushState","url","search","searchTerm","console","log","fetch","replace","headers","Authorization","then","response","json","jsonResponse","tracks","items","map","track","id","name","artist","artists","album","uri","savePlaylist","playlistName","trackUris","Authorizaion","ok","alert","userId","method","body","JSON","stringify","nameResponse","playlistId","uris","tracksResponse"],"mappings":"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","sourcesContent":["let accessToken;\nlet expiresIn;\nconst clientId = \"59649a72094c46508c95980e7a188a9d\";\nconst authEndpoint = \"https://accounts.spotify.com/authorize\";\nconst redirectUri = \"https://everly.surge.sh\";\n//const redirectUri = \"http://localhost:3000\";\n\nconst Spotify = {\n  getAccessToken() {\n    if (accessToken) {\n      return accessToken;\n    } else {\n      accessToken = window.location.href.match(/access_token=([^&]*)/);\n      expiresIn = window.location.href.match(/expires_in=([^&]*)/);\n      if (accessToken && expiresIn) {\n        window.setTimeout(() => (accessToken = \"\"), expiresIn * 1000);\n        window.history.pushState(\"Access Token\", null, \"/\");\n        return accessToken;\n      } else {\n        let url = `${authEndpoint}?client_id=${clientId}&response_type=token&scope=playlist-modify-public&redirect_uri=${redirectUri}`;\n        window.location = url;\n      }\n    }\n  },\n\n  search(searchTerm) {\n    accessToken = this.getAccessToken();\n    console.log(accessToken);\n    return fetch(\n      `https://api.spotify.com/v1/search?type=track&q=${searchTerm.replace(\n        \" \",\n        \"%20\"\n      )}`,\n      {\n        headers: { Authorization: `Bearer ${accessToken}` }\n      }\n    )\n      .then(response => {\n        return response.json();\n      })\n      .then(jsonResponse => {\n        if (jsonResponse.tracks.items) {\n          return jsonResponse.tracks.items.map(track => ({\n            id: track.id,\n            name: track.name,\n            artist: track.artists[0].name,\n            album: track.album.name,\n            uri: track.uri\n          }));\n        }\n      });\n  },\n\n  async savePlaylist(playlistName, trackUris) {\n    if (!playlistName || !trackUris) {\n      return;\n    }\n    accessToken = this.getAccessToken();\n    console.log(accessToken);\n    let headers = { Authorizaion: `Bearer ${accessToken}` };\n    let userId;\n    try {\n      let response = await fetch(\"https://api.spotify.com/v1/me\", {\n        headers: headers\n      });\n      if (!response.ok) {\n        alert(\"There was a problem retrieving your user ID.\");\n        return;\n      }\n      let jsonResponse = await response.json();\n      userId = jsonResponse.id;\n      let nameResponse = await fetch(\n        `https://api.spotify.com/v1/users/${userId}/playlists`,\n        {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${accessToken}`,\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            name: playlistName\n          })\n        }\n      );\n      if (!nameResponse.ok) {\n        alert(\"There was a problem posting the playlist name.\");\n        return;\n      }\n      jsonResponse = await nameResponse.json();\n      const playlistId = jsonResponse.id;\n\n      let tracksResponse = await fetch(\n        `https://api.spotify.com/v1/playlists/${playlistId}/tracks`,\n        {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${accessToken}`,\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({ uris: trackUris })\n        }\n      );\n      if (!tracksResponse.ok) {\n        alert(\"There was a problem posting the playlist tracks.\");\n        return;\n      }\n    } catch (error) {\n      console.log(error);\n      return;\n    }\n    return \"Done\";\n  }\n};\n\nexport default Spotify;\n"]},"metadata":{},"sourceType":"module"}